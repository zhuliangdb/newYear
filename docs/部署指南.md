# 部署指南

本文档详细介绍了项目的部署流程，包括环境配置、构建过程和部署步骤。

## 前提条件

在部署项目之前，确保您已经安装了以下软件：

- Node.js 18.x 或更高版本
- npm 9.x 或更高版本
- Git

## 本地开发环境设置

### 1. 克隆仓库

```bash
git clone https://github.com/zhuliangdb/newYear.git
cd newYear
```

### 2. 安装依赖

```bash
cd frontend
npm install
```

### 3. 启动开发服务器

```bash
npm run dev
```

开发服务器启动后，您可以在浏览器中访问 `http://localhost:5173` 查看项目。

## 生产环境部署

### 1. 构建项目

在部署之前，需要先构建生产版本：

```bash
cd frontend
npm run build
```

构建完成后，生成的静态文件会存放在 `frontend/dist` 目录中。

### 2. 部署到 GitHub Pages

本项目使用 GitHub Actions 自动部署到 GitHub Pages。当您推送到 `main` 分支时，部署流程会自动触发。

#### 部署配置

部署配置文件位于 `.github/workflows/deploy.yml`，主要步骤包括：

1. 检出代码
2. 设置 Node.js 环境
3. 安装依赖
4. 构建项目
5. 部署到 GitHub Pages

#### 部署状态

您可以在 GitHub 仓库的 "Actions" 选项卡中查看部署状态和日志。

### 3. 自定义域名（可选）

如果您想使用自定义域名，可以在 `deploy.yml` 文件中修改 `cname` 参数：

```yaml
cname: your-domain.com
```

同时，您需要在 DNS 提供商处设置相应的 DNS 记录。

## 环境变量配置

项目使用 `.env` 文件存储环境变量。在部署之前，确保您已经配置了正确的环境变量：

### 前端环境变量

在 `frontend/.env` 文件中配置：

```env
# Firebase 配置
VITE_FIREBASE_API_KEY=your-api-key
VITE_FIREBASE_AUTH_DOMAIN=your-auth-domain
VITE_FIREBASE_PROJECT_ID=your-project-id
VITE_FIREBASE_STORAGE_BUCKET=your-storage-bucket
VITE_FIREBASE_MESSAGING_SENDER_ID=your-messaging-sender-id
VITE_FIREBASE_APP_ID=your-app-id
VITE_FIREBASE_MEASUREMENT_ID=your-measurement-id

# 其他配置
VITE_API_BASE_URL=your-api-base-url
```

## 部署故障排除

### 常见问题

1. **依赖安装失败**
   - 检查网络连接
   - 确保 Node.js 和 npm 版本符合要求
   - 尝试删除 `node_modules` 目录和 `package-lock.json` 文件，然后重新安装依赖

2. **构建失败**
   - 检查代码中是否有语法错误
   - 确保所有环境变量都已正确配置
   - 查看构建日志以获取详细错误信息

3. **部署失败**
   - 检查 GitHub Actions 日志以获取详细错误信息
   - 确保 `publish_dir` 路径正确
   - 确保 GitHub Pages 分支设置正确

### 调试技巧

- 使用 `npm run build` 命令在本地测试构建过程
- 检查 `frontend/dist` 目录结构，确保所有必要的文件都已生成
- 使用浏览器开发工具检查网络请求和控制台错误

## 监控和维护

### 监控

- 定期检查 GitHub Actions 部署状态
- 监控网站访问量和性能指标
- 检查浏览器控制台错误和网络请求失败

### 维护

- 定期更新依赖包以修复安全漏洞
- 备份重要数据
- 优化网站性能
- 修复用户报告的问题

## 结论

通过本指南，您应该能够成功部署和维护项目。如果您遇到任何问题，请参考故障排除部分或联系开发团队寻求帮助。
